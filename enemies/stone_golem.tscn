[gd_scene load_steps=18 format=3 uid="uid://dnh1vy206kekx"]

[ext_resource type="PackedScene" uid="uid://ckp8pbos4m2tb" path="res://enemies/enemy.tscn" id="1_tpu2m"]
[ext_resource type="Script" path="res://enemies/stone_golem.gd" id="2_0ycfc"]
[ext_resource type="Texture2D" uid="uid://dasvwtpvnpbhh" path="res://assets/art/Stone_golem/Stone-golem v2-all animations-224x192.png" id="3_gg0sh"]
[ext_resource type="AudioStream" uid="uid://cbnu33mbh86o8" path="res://assets/audio/spawn/Fantasy_Game_Magic_Earth_Long_Cast_Spell_A.wav" id="4_n3dxx"]
[ext_resource type="PackedScene" uid="uid://u5resou4a16m" path="res://enemies/actions/stone_golem_clap.tscn" id="5_6v2bx"]
[ext_resource type="PackedScene" uid="uid://dfa4x1vdn6ddq" path="res://enemies/actions/stomp_attack.tscn" id="6_4r3ok"]
[ext_resource type="PackedScene" uid="uid://dp5nl7vmwkymq" path="res://enemies/actions/chase.tscn" id="7_j2nfn"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_06v5d"]
size = Vector2(205, 204)

[sub_resource type="Animation" id="Animation_icx16"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_m3jaf"]
resource_name = "attack"
length = 2.55
step = 0.15
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05, 1.2, 1.35, 1.5, 1.65, 1.8, 1.95, 2.1, 2.25, 2.4),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Attack_Clap")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1.2, 1.35, 2.55),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"values": [{
"args": [1.8],
"method": &"play_ability_audio"
}, {
"args": [],
"method": &"check_overlapping"
}, {
"args": [],
"method": &"spawn_projectile"
}, {
"args": [],
"method": &"end"
}]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".:can_be_staggered")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 2.55),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [false, true]
}

[sub_resource type="Animation" id="Animation_0ioqs"]
resource_name = "death"
length = 1.95
step = 0.15
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05, 1.2, 1.35, 1.5, 1.65, 1.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]
}

[sub_resource type="Animation" id="Animation_m0mfp"]
resource_name = "hit"
length = 1.8
step = 0.15
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05, 1.2, 1.35, 1.5, 1.65),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62]
}

[sub_resource type="Animation" id="Animation_2ph1s"]
resource_name = "idle"
length = 1.2
loop_mode = 1
step = 0.15
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3, 4, 5, 6, 7]
}

[sub_resource type="Animation" id="Animation_8slym"]
resource_name = "spawn"
length = 2.1
step = 0.15
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05, 1.2, 1.35, 1.5, 1.65, 1.8, 1.95),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [80, 79, 78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68, 52]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:has_spawned")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(2.1),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(1.8),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [2.0],
"method": &"shake_player_camera"
}]
}

[sub_resource type="Animation" id="Animation_ae4b1"]
resource_name = "stomp"
length = 0.55
step = 0.05
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.4),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [17, 18]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Attack_Stomp")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.4, 0.55),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [],
"method": &"check_overlapping"
}, {
"args": [],
"method": &"end"
}]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Attack_Stomp")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.4),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [1.53],
"method": &"play_ability_audio"
}, {
"args": [],
"method": &"trigger_shader"
}]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath(".:can_be_staggered")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.55),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [false, true]
}

[sub_resource type="Animation" id="Animation_qdb65"]
resource_name = "walk"
length = 1.2
loop_mode = 1
step = 0.15
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [17, 18, 19, 20, 21, 22, 23, 24]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.15, 0.75),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [0.1],
"method": &"shake_player_camera"
}, {
"args": [0.1],
"method": &"shake_player_camera"
}]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.75, 0.9),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"values": [{
"args": [],
"method": &"unfreeze_movement"
}, {
"args": [],
"method": &"freeze_movement"
}, {
"args": [],
"method": &"unfreeze_movement"
}, {
"args": [],
"method": &"freeze_movement"
}, {
"args": [],
"method": &"unfreeze_movement"
}]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_6wywk"]
_data = {
"RESET": SubResource("Animation_icx16"),
"attack": SubResource("Animation_m3jaf"),
"death": SubResource("Animation_0ioqs"),
"hit": SubResource("Animation_m0mfp"),
"idle": SubResource("Animation_2ph1s"),
"spawn": SubResource("Animation_8slym"),
"stomp": SubResource("Animation_ae4b1"),
"walk": SubResource("Animation_qdb65")
}

[node name="stone_golem" instance=ExtResource("1_tpu2m")]
z_index = 1
y_sort_enabled = true
script = ExtResource("2_0ycfc")
wait_min = 0.25
wait_max = 2.5
can_be_staggered = true
time_to_ignore_hits = 5.0
has_spawned = true
look_for_player = true
max_health = 300
max_walk_speed = 200
can_run = false

[node name="Character_Hitbox" parent="." index="0"]
visible = false
z_index = 3
position = Vector2(0.5, -15)
shape = SubResource("RectangleShape2D_06v5d")

[node name="Sprite2D" parent="." index="1"]
y_sort_enabled = true
scale = Vector2(3, 3)
texture = ExtResource("3_gg0sh")
hframes = 17
vframes = 5

[node name="AnimationPlayer" parent="." index="2"]
libraries = {
"": SubResource("AnimationLibrary_6wywk")
}

[node name="Spawn_AudioPlayer" type="AudioStreamPlayer2D" parent="." index="5"]
stream = ExtResource("4_n3dxx")

[node name="Attack_Clap" parent="." index="6" instance=ExtResource("5_6v2bx")]

[node name="Attack_Stomp" parent="." index="7" instance=ExtResource("6_4r3ok")]
y_sort_enabled = true
position = Vector2(0, -2)

[node name="Chase" parent="." index="8" instance=ExtResource("7_j2nfn")]

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="." index="9"]
debug_path_custom_color = Color(1, 0, 0, 1)
debug_path_custom_point_size = 8.0

[node name="StaggerTimer" type="Timer" parent="." index="10"]

[node name="WaitTimer" type="Timer" parent="." index="11"]
wait_time = 2.0

[connection signal="timeout" from="StaggerTimer" to="." method="_on_stagger_timer_timeout"]
[connection signal="timeout" from="WaitTimer" to="." method="_on_wait_timer_timeout"]
